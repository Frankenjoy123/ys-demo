<!-- Content Header (Page header) -->
<section class="content-header">
    <h1>
        产品码管理
        <!--<small>Control panel</small>-->
    </h1>
    <ol class="breadcrumb">
        <li><a href="#"><i class="fa fa-dashboard"></i>首页</a></li>
        <li class="active">产品码管理</li>
    </ol>
</section>
<!-- Main content -->
<section class="content" ng-controller="productKeyManageCtrl">

    <div class="box box-solid">
        <div class="box-header">
            <h3 class="box-title">创建新的产品码</h3>
        </div>
        <!-- /.box-header -->
        <form role="form" id="createForm">
            <div class="box-body">
                <div class="row">
                    <div class="form-group col-xs-4">
                        <label>产品：</label>
                        <select name="productType"
                                class="form-control inline"
                                ng-model="creationPanel.model.productBaseId"
                                ng-change="creationPanel.productBaseIdChanged(creationPanel.model.productBaseId)">
                            <option value="0">请选择</option>
                            <option ng-repeat="pb in creationPanel.productBases" value="{{pb.id}}">
                                {{pb.name}}
                            </option>
                        </select>

                    </div>
                    <div class="form-group col-xs-4">
                        <label>数量：</label>
                        <!--<input type="text" name="quantity" ng-model="creationModel.quantity" class="form-control inline"-->
                        <!--placeholder=""/>-->
                        <select name="quantity" ng-model="creationPanel.model.quantity" class="form-control inline">
                            <option value="0">请选择</option>
                            <option value="1">1万</option>
                            <option value="2">2万</option>
                            <option value="5">5万</option>
                            <option value="10">10万</option>
                            <option value="50">50万</option>
                        </select>
                    </div>
                </div>
                <div class="row" ng-show="creationPanel.selectedProductBase">
                    <div class="form-group col-xs-4">
                        <label>产品码类型：</label>

                        <div class="checkbox inline">
                            {{formatProductKeyTypes(creationPanel.selectedProductBase.productKeyTypes)}}
                        </div>
                    </div>
                </div>
            </div>
            <!-- /.box-body -->
            <div class="box-footer">
                <button type="submit" class="btn btn-primary" ng-click="creationPanel.create()">创建</button>
                <!--<div class="clearfix"></div>-->
            </div>

        </form>

    </div>
    <!-- /.box -->

    <div class="box-group">
        <div class="panel box box-success" ng-show="listPanel.newProductKeyBatches.length > 0">
            <!--track by $index-->
            <a data-toggle="collapse" href="" data-target="#collapse_new">
                <div class="box-header">
                    <h4 class="box-title">
                        新创建
                    </h4>
                </div>
            </a>

            <div id="collapse_new" class="panel-collapse collapse in">
                <div class="box-body">
                    <table class="table table-hover">
                        <tr>
                            <th style="width: 10%">产品</th>
                            <th style="width: 10%">ID</th>
                            <th style="width: 10%">数量</th>
                            <th style="width: 25%">产品码类型</th>
                            <th>创建时间</th>
                            <th style="width: 10%">操作</th>
                        </tr>
                        <tr ng-repeat="b in listPanel.newProductKeyBatches">
                            <td>{{b.productBase.name}}</td>
                            <td>{{b.id}}</td>
                            <td>{{b.quantity}}</td>
                            <td>
                                {{formatProductKeyTypes(b.productKeyTypes)}}
                            </td>
                            <td>{{getDateString(b.createdDateTime)}}</td>
                            <td>
                                <button type="button" class="btn btn-success btn-xs"
                                        ng-click="listPanel.download(b.id)">下载
                                </button>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
        <!-- we are adding the .panel class so bootstrap.js collapse plugin detects it -->
        <div class="panel box box-primary" ng-repeat="batch in listPanel.productKeyBatches track by $id(batch)">
            <!--track by $index-->
            <a data-toggle="collapse" href="" data-target="#collapse{{batch.productBase.id}}">
                <div class="box-header">
                    <h4 class="box-title">
                        {{batch.productBase.name}}
                    </h4>
                </div>
            </a>

            <div id="collapse{{batch.productBase.id}}" class="panel-collapse collapse in">
                <div class="box-body">
                    <table class="table table-hover">
                        <tr>
                            <th style="width: 10%">ID</th>
                            <th style="width: 10%">数量</th>
                            <th style="width: 25%">产品码类型</th>
                            <th>创建时间</th>
                            <th style="width: 10%">操作</th>
                        </tr>
                        <tr ng-repeat="b in batch.batches">
                            <td>{{b.id}}</td>
                            <td>{{b.quantity}}</td>
                            <td>
                                {{formatProductKeyTypes(b.productKeyTypes)}}
                            </td>
                            <td>{{getDateString(b.createdDateTime)}}</td>
                            <td>
                                <button type="button" class="btn btn-success btn-xs"
                                        ng-click="listPanel.download(b.id)">下载
                                </button>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
        <iframe width="0" height="0" ng-src="{{listPanel.downloadFrameSrc}}"></iframe>
    </div>
</section><!-- /.content -->
